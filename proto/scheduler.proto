syntax = "proto3";

package scheduler;

option go_package = "github.com/bhanuprakaash/job-scheduler/proto";

// JobScheduler is the core service for managing background tasks.
//
// It allows clients to submit asynchronous jobs (like emails, billing, resizing)
// and poll for their status. This service is designed to be horizontally scalable
// and backed by a persistent store.
service JobScheduler {
  // SubmitJob enqueues a new job for execution.
  // It returns the generated Job ID and Status immediately while the job runs in the background.
  rpc SubmitJob(SubmitJobRequest) returns (SubmitJobResponse);

  // GetJob retrieves the current status and details of a specific job.
  // Use this to poll for completion or to retrieve the output of a finished job.
  // Errors:
  //  - NOT_FOUND: Returned if the provided job_id does not exist in the store.
  //  - INVALID_ARGUMENT: Returned if the job_id is malformed.
  rpc GetJob(GetJobRequest) returns (GetJobResponse);
}

message SubmitJobRequest {
  string type    = 1;
  string payload = 2;
}

message SubmitJobResponse {
  string job_id = 1;
  string status = 2;
}

message GetJobRequest {
  string job_id = 1;
}

message GetJobResponse {
  string job_id        = 1;
  string type          = 2;
  string payload       = 3;
  string status        = 4;
  string created_at    = 5;
  string completed_at  = 6;
  string error_message = 7;
  string retry_count   = 8;
}